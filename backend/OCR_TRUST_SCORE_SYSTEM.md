# ğŸ” OCR + TRUST SCORE VERIFICATION SYSTEM

## ğŸ“‹ Ù…Ú©Ù…Ù„ Ù†Ø¸Ø§Ù… (Complete System)

ÛŒÛ system ØªÛŒÙ† Ø¨Ú‘Û’ Ø­ØµÙˆÚº Ù¾Ø± Ù…Ø´ØªÙ…Ù„ ÛÛ’:

### 1ï¸âƒ£ OCR (Optical Character Recognition) Verification
### 2ï¸âƒ£ Trust Score Management System  
### 3ï¸âƒ£ Earnings Lock & Withdrawal System

---

## ğŸ¯ Ø³Ø³Ù¹Ù… Ú©ÛŒØ³Û’ Ú©Ø§Ù… Ú©Ø±ØªØ§ ÛÛ’ØŸ

### Freelancer Ú©ÛŒ Ø¬Ø§Ù†Ø¨ Ø³Û’:

```
1. Task Ú©Ùˆ claim Ú©Ø±ØªØ§ ÛÛ’
   â†“
2. Page/Channel Ø¬Ø§ØªØ§ ÛÛ’
   â†“
3. Follow/Subscribe/Like Ú©Ø±ØªØ§ ÛÛ’ (minimum 1 minute)
   â†“
4. Screenshot Ù„ÛŒØªØ§ ÛÛ’ (followers count Ø¯ÙˆÙ†ÙˆÚº Ø¯Ú©Ú¾Ø§Ø¦Û’ ÛÙˆÚº)
   â†“
5. Screenshot upload Ú©Ø±ØªØ§ ÛÛ’
   â†“
6. â±ï¸ TIME CHECK: Ú©ÛŒØ§ 1 minute Ø³Û’ Ø²ÛŒØ§Ø¯Û ÛÛ’ØŸ
   â”œâ”€ âŒ NO (< 1 min): Task rejected, -10 trust score
   â””â”€ âœ… YES (â‰¥ 1 min): OCR verification Ø´Ø±ÙˆØ¹
     â†“
7. ğŸ“¸ OCR CHECK: Ú©ÛŒØ§ page name screenshot Ù…ÛŒÚº visible ÛÛ’?
   â”œâ”€ âŒ NO: Task rejected
   â””â”€ âœ… YES: Followers count check
     â†“
8. ğŸ“Š FOLLOWER COUNT CHECK: Ú©ÛŒØ§ followers Ø¨Ú‘Ú¾Û’ØŸ
   â”œâ”€ âŒ NO: Task rejected
   â””â”€ âœ… YES: Task verified âœ…
     â†“
9. ğŸ’° PAYMENT: Reward wallet Ù…ÛŒÚº added
   (Ù„ÛŒÚ©Ù† LOCKED ÛÛ’ trust score Ú©ÛŒ Ø¨Ù†ÛŒØ§Ø¯ Ù¾Ø±)
```

---

## ğŸ“Š Trust Score Levels Ø§ÙˆØ± Earnings Lock

### ğŸŸ¢ High Trust (> 70%)
```
âœ… Lock Duration: 10 days
âœ… Max Withdrawal: Unlimited
âœ… Benefits: Ø³Ø¨ Ú©Ú†Ú¾ Ú©Ø±ÛŒÚº Ø³Ú©ØªÛ’ ÛÙˆ
```

### ğŸŸ¡ Medium Trust (61-70%)
```
ğŸŸ¨ Lock Duration: 15 days
ğŸŸ¨ Max Withdrawal: $7 (700 cents) per request
ğŸŸ¨ Limited: Ø¨ÛØªØ±ÛŒ Ú©ÛŒ Ø¶Ø±ÙˆØ±Øª ÛÛ’
```

### ğŸŸ  Low Trust (51-60%)
```
âš ï¸ Lock Duration: 15 days
âš ï¸ Max Withdrawal: $5 (500 cents) per request
âš ï¸ Restricted: Ø¨ÛØª Ù…Ø­Ø¯ÙˆØ¯
```

### ğŸ”´ Banned (â‰¤ 50%)
```
âŒ Account Banned
âŒ Earnings Locked (Ø³Ø¨ locked)
âŒ Cannot perform tasks
ğŸ’¸ Unlock Cost:
   - 1st Ban: $3 (300)
   - 2nd Ban: $5 (500)
   - 3rd Ban: $10 (1000)
```

---

## â° Time Penalty System

### Ø§Ú¯Ø± 1 minute Ø³Û’ Ù¾ÛÙ„Û’ exit Ú©Ø±Ùˆ:

```
âŒ Early Exit < 1 min
  â†“
ğŸ“‰ Trust Score -10
  â†“
âŒ Task rejected
  â†“
ğŸ”„ Task ÙˆØ§Ù¾Ø³ pending Ù…ÛŒÚº
  â†“
ğŸ” Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø± Ø³Ú©ØªÛ’ ÛÙˆ
```

---

## ğŸ¯ Trust Score Ú©Ø§ Ø§Ø«Ø±

### Trust Score Ú©Ù… ÛÙˆ Ø±ÛØ§ ÛÛ’ØŸ

```
Trust Score: 100% â†’ 95% â†’ 90% â†’ ... â†’ 70% â†’ 60% â†’ 50% â†’ BAN
                                                      â†“
                                          Pay to unlock
```

### Ú©Ø³ Ú†ÛŒØ² Ø³Û’ trust score Ú©Ù… ÛÙˆØªØ§ ÛÛ’:

1. **Early Exit** (-10)
   - 1 minute Ø³Û’ Ù¾ÛÙ„Û’ task Ø³Û’ Ø¨Ø§ÛØ± Ù†Ú©Ù„Ùˆ

2. **Failed Verification** (-0)
   - Fail ÛÙˆ ØªÙˆ penalty Ù†ÛÛŒÚºØŒ sirf retry

3. **Admin Actions** (custom)
   - Admin manually decrease Ú©Ø± Ø³Ú©ØªØ§ ÛÛ’

---

## ğŸ’° Earnings Lock Ø§ÙˆØ± Withdrawal

### Ú©ÛŒØ³Û’ Ú©Ø§Ù… Ú©Ø±ØªØ§ ÛÛ’:

```
Task Complete (verified & paid)
  â†“
ğŸ’µ Reward added to wallet
  â†“
ğŸ”’ LOCKED for X days (based on trust score)
  â†“
After X days:
  â”œâ”€ Trust > 70%: Unlimited access
  â”œâ”€ Trust 61-70%: Max $7 per withdrawal
  â”œâ”€ Trust 51-60%: Max $5 per withdrawal
  â””â”€ Trust â‰¤ 50%: BANNED
```

### Withdrawal Process:

```
1. User: Withdrawal request submit Ú©Ø±ØªØ§ ÛÛ’
   â†“
2. Admin: Admin approve Ú©Ø±ØªØ§ ÛÛ’
   â†“
3. Payment: Bank/PayPal/Crypto Ù…ÛŒÚº transfer
   â†“
4. User: Notification Ù…Ù„ØªÛŒ ÛÛ’
```

---

## ğŸ–¼ï¸ OCR Verification Details

### Ú©ÛŒØ§ OCR check Ú©Ø±ØªØ§ ÛÛ’:

1. **Page Name Extraction**
   ```
   Screenshot â†’ Tesseract OCR â†’ "Facebook" text extracted
   ```

2. **Name Matching**
   ```
   Target Page: "facebook.com/mybrand"
   Extracted: "Facebook", "mybrand"
   Match: âœ… YES
   ```

3. **Follower Count Tracking**
   ```
   Before: 1000 followers
   After:  1001 followers (screenshot Ù…ÛŒÚº visible)
   Increase: âœ… YES â†’ Verified
   ```

### OCR Ú©ÛŒØ§ extract Ù†ÛÛŒÚº Ú©Ø± Ø³Ú©ØªØ§ ØªÙˆ:

```
âŒ Page name visible Ù†ÛÛŒÚº
âŒ Screenshot ØºÙ„Ø· ÛÛ’
âŒ OCR fail ÛÙˆ
  â†“
Task Rejected
Penalty: -10 Trust Score (early exit Ú©ÛŒ ØµÙˆØ±Øª Ù…ÛŒÚº)
```

---

## ğŸ”§ Admin Controls

### Admin Ú©Ùˆ ÛŒÛ features ÛÛŒÚº:

#### 1. Trust Score Management
```
POST /api/admin-panel/users/:userId/trust-score/increase
POST /api/admin-panel/users/:userId/trust-score/decrease
```

#### 2. Ban Management
```
GET /api/admin-panel/ban-records
POST /api/admin-panel/ban/:banId/unlock
```

#### 3. Withdrawal Approval
```
GET /api/admin-withdrawals/pending
POST /api/admin-withdrawals/:withdrawalId/approve
POST /api/admin-withdrawals/:withdrawalId/reject
```

#### 4. Audit Trail
```
Admin Log Ù…ÛŒÚº ØªÙ…Ø§Ù… actions record ÛÙˆØªÛ’ ÛÛŒÚº
```

---

## ğŸ“± API Endpoints

### FREELANCER ENDPOINTS

#### Task Management
```
GET  /api/campaigns/available-tasks
POST /api/campaigns/tasks/:taskId/assign
GET  /api/campaigns/my-tasks
```

#### Verification
```
POST /api/campaigns/tasks/:taskId/submit-proof
Body: {
  image: "base64_string",
  followersBefore: 1000,
  followersAfter: 1001
}
```

#### Earnings & Withdrawals
```
GET  /api/campaigns/earnings-status
GET  /api/campaigns/trust-score
GET  /api/withdrawals/status
POST /api/withdrawals/request
GET  /api/withdrawals/history
POST /api/withdrawals/:withdrawalId/cancel
```

### ADMIN ENDPOINTS

#### Trust Score
```
POST /api/admin-panel/users/:userId/trust-score/increase
POST /api/admin-panel/users/:userId/trust-score/decrease
GET  /api/admin-panel/users/:userId/trust-score/history
```

#### Ban Management
```
GET  /api/admin-panel/ban-records
POST /api/admin-panel/ban/:banId/unlock
```

#### Withdrawals
```
GET  /api/admin-withdrawals/pending
POST /api/admin-withdrawals/:withdrawalId/approve
POST /api/admin-withdrawals/:withdrawalId/reject
```

---

## ğŸ“¦ Database Schema

### New Tables/Fields

#### User Model (Updated)
```prisma
trustScore Float @default(100.0)  // 0-100%
isBanned Boolean @default(false)
banCount Int @default(0)
banReason String?
banUnlockCost Int?
```

#### CampaignProof Model (Updated)
```prisma
// OCR Fields
ocrPageName String?
ocrMatches Boolean?

// Count Tracking
followersBefore Int?
followersAfter Int?
countIncreased Boolean?

// Time Tracking
taskStartTime DateTime?
proofSubmitTime DateTime @default(now())
timeMinutes Int?
earlyExitPenalty Boolean?
trustPenaltyApplied Int @default(0)
```

#### BanRecord (New)
```prisma
userId Int
banCount Int (1, 2, or 3)
reason String
unlockCost Int (300, 500, or 1000)
paid Boolean
unlockedAt DateTime?
```

#### TrustScoreLog (New)
```prisma
userId Int
oldScore Float
newScore Float
change Float
reason String
adminId Int?
```

#### EarningsLock (New)
```prisma
userId Int
amount Int (in cents)
lockDays Int (10, 15, or 20)
maxWithdraw Int?
unlockedAt DateTime
withdrawn Int @default(0)
```

---

## ğŸ¬ Workflow Examples

### Example 1: Successful Verification

```
1. Freelancer: 1000 followers
2. Task: Follow "TechBrand" page
3. Freelancer: Spends 2 minutes, follow page
4. Freelancer: Takes screenshot (1000 â†’ 1001 followers)
5. System:
   - Time check: 2 min â‰¥ 1 min âœ…
   - OCR: "TechBrand" detected âœ…
   - Count: 1001 > 1000 âœ…
6. Result: VERIFIED & PAID
   - Reward: $0.40 added
   - Status: Locked for 10 days (trust > 70%)
7. Notification: "âœ… Task Verified & Paid"
```

### Example 2: Early Exit Penalty

```
1. Freelancer: Starts task
2. 30 seconds Ù…ÛŒÚº: Exit Ú©Ø± Ø¯ÛŒØªØ§ ÛÛ’
3. System:
   - Time check: 30 sec < 1 min âŒ
4. Result: REJECTED
   - Task: Reverted to pending
   - Trust Score: 100% â†’ 90% (-10)
   - Status: Can retry later
5. Notification: "âŒ Task exited early. -10 trust score"
```

### Example 3: OCR Mismatch

```
1. Freelancer: Submit screenshot
2. System:
   - Time check: 2 min âœ…
   - OCR: "Wrong Page" extracted âŒ
   - Count: Increased âœ…
3. Result: REJECTED
   - Task: Reverted
   - Reason: "Page name doesn't match"
   - Penalty: None (wasn't early exit)
4. Notification: "âŒ OCR verification failed"
```

### Example 4: Trust Score Drops to Banned

```
Trust Score: 100%
  â†“ (Early exit, -10)
90% [OK]
  â†“ (Admin decrease, -20)
70% [OK - HIGH]
  â†“ (Multiple penalties, -15)
55% [LOW]
  â†“ (Failed verifications, -5)
50% [BANNED âŒ]
  
Now:
- Cannot perform tasks
- Earnings fully locked
- Must pay to unlock:
  - If 1st ban: Pay $3
  - If 2nd ban: Pay $5
  - If 3rd ban: Pay $10
```

---

## âš™ï¸ Configuration

### Trust Score Config (src/services/trust-score.ts)

```typescript
const config = {
  penaltyEarlyExit: 10,         // -10 for < 1 min
  banThreshold: 50,              // Ban at â‰¤ 50%
  lockDaysHigh: 10,              // > 70% = 10 days
  lockDaysMedium: 15,            // 51-70% = 15 days
  maxWithdrawHigh: null,         // > 70% = unlimited
  maxWithdrawMedium: 700,        // 61-70% = $7
  maxWithdrawMediumLow: 500,     // 51-60% = $5
  banUnlockCost1: 30000,         // 1st = $300
  banUnlockCost2: 50000,         // 2nd = $500
  banUnlockCost3: 100000         // 3rd = $1000
};
```

---

## ğŸ“Š Monitoring & Analytics

### Admin Dashboard Stats

```
Total Verifications: 15,234
Success Rate: 87%
Failed: 13%
Average Time: 3.2 minutes
Early Exits: 5%

Users by Trust Score:
- High (>70%): 1,234 users
- Medium (61-70%): 567 users
- Low (51-60%): 234 users
- Banned (â‰¤50%): 89 users
```

---

## ğŸš€ Deployment Checklist

- [x] Database migration applied
- [x] OCR service created (with Tesseract.js)
- [x] Trust score system implemented
- [x] Earnings lock system implemented
- [x] Withdrawal system implemented
- [x] Admin controls added
- [x] Frontend UI created
- [x] API endpoints tested
- [ ] Production API keys configured (Facebook, YouTube, Instagram)
- [ ] Email notifications setup
- [ ] Monitor fraud patterns
- [ ] Admin training

---

## ğŸ”’ Security Measures

1. **JWT Authentication** - Secure token validation
2. **Time Validation** - Prevent instant click-and-claim
3. **OCR Validation** - Prevent fake screenshots
4. **Trust Score** - Penalize bad behavior
5. **Admin Audit** - All admin actions logged
6. **Rate Limiting** - Prevent spam
7. **Database Constraints** - Foreign key validations

---

## ğŸ“ Summary of Key Changes

| Feature | Before | After |
|---------|--------|-------|
| Verification | Manual screenshot check | Automated OCR + count verification |
| Time Validation | None | Required 1 minute minimum |
| Penalties | None | -10 for early exit |
| Earnings Lock | None | 10/15/20 days based on trust |
| Withdrawal Limits | Unlimited | Based on trust score |
| Ban System | Simple ban | Progressive ban (3 levels with costs) |
| Admin Control | Limited | Full trust score management |

---

## ğŸ“ Support

For issues or questions:
- Admin Panel: `/api/admin-panel`
- Campaigns: `/api/campaigns`
- Withdrawals: `/api/withdrawals`
- Logs: Check AdminLog table

---

**System Status**: âœ… Ready for deployment

**Last Updated**: January 19, 2026
